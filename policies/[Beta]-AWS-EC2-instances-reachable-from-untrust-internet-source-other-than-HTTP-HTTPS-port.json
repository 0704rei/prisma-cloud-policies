{
  "policyUpi": "PC-ALL-ALL-803",
  "policyId": "ad23603d-754e-4499-8988-b80178785898",
  "policyType": "network",
  "cloudType": "aws",
  "severity": "high",
  "name": "[Beta] AWS EC2 instances reachable from untrust internet source other than HTTP/HTTPS port",
  "description": "This policy identifies EC2 instances that are exposed to inbound traffic from the internet. Exposure to the internet may enable bad actors to use brute force on a system to gain unauthorized access to the entire network. As a best practice, restrict traffic from unknown IP addresses and limit the access to known hosts, services, or specific entities. \n\nNOTE: We are excluding the HTTP-80 and HTTPs-443 web ports as these are Internet-facing ports with legitimate traffic.",
  "rule.criteria": "893e3897-af4b-4cbe-b665-23e1f19f8f0b",
  "searchModel.query": "config from network where source.network = UNTRUST_INTERNET and dest.resource.type = 'Instance' and dest.cloud.type = 'AWS' and protocol.ports in ( 'tcp/0:79', 'tcp/81:442', 'tcp/444:65535' )",
  "recommendation": "The following steps are recommended to restrict traffic from the Internet:\n1. Visit the Network path Analysis from Source to Destination and review the network path components that allow internet access.\n2. Identify the network component on which restrictive rules can be implemented.\n3. Implement the required changes and make sure no other resources have been impacted due to these changes:\n a) The overly permissive Security Group rules can be made more restrictive.\n b) Move the instance inside a restrictive subnet if the instance does not need to be publicly accessible.\n c) Define a NAT rule to restrict traffic coming from the Internet to the respective instance.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": ""
}