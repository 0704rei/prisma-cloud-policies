{
  "0": [
    {
      "policyId": "b76ad441-e715-4fd0-bbc3-cd3b2bee34bf",
      "policyType": "config",
      "cloudType": "aws",
      "severity": "high",
      "name": "AWS CloudTrail bucket is publicly accessible",
      "description": "This policy identifies publicly accessible S3 buckets that store CloudTrail data. These buckets contains sensitive audit data and only authorized users and applications should have access.",
      "rule.criteria": "f940021d-42bc-4f29-b9f9-0ae819318ba9",
      "searchModel.query": "config where cloud.type = 'aws' and api.name = 'aws-s3api-get-bucket-acl' as X; config where api.name = 'aws-cloudtrail-describe-trails' as Y; filter '$.X.bucketName equals $.Y.s3BucketName and ((($.X.acl.grants[*].grantee contains AllUsers or $.X.policyStatus.isPublic is true) and $.X.publicAccessBlockConfiguration does not exist) or ($.X.acl.grants[*].grantee contains AllUsers and $.X.publicAccessBlockConfiguration.ignorePublicAcls is false) or ($.X.policyStatus.isPublic is true and $.X.publicAccessBlockConfiguration.restrictPublicBuckets is false))' ; show X;",
      "recommendation": "1. Login to the AWS Console\n2. Navigate to the 'S3' service\n3. Click on the 'S3' resource reported in the alert\n4. Click on the 'Permissions'\n5. If Access Control List' is set to 'Public' follow below steps\na. Under 'Access Control List', Click on 'Everyone' and uncheck all items\nb. Click on Save\n6. If 'Bucket Policy' is set to public follow below steps\na. Under 'Bucket Policy', modify the policy to remove public access\nb. Click on Save\nc. If 'Bucket Policy' is not required delete the existing 'Bucket Policy'.\n\nNote: Make sure updating 'Access Control List' or 'Bucket Policy' does not affect S3 bucket data access.",
      "remediable": true,
      "remediation.cliScriptTemplate": "aws s3api put-bucket-acl --acl private --bucket ${resourceName}",
      "remediation.description": "This CLI command requires 's3:PutBucketAcl' permission. Successful execution will reset this CloudTrail bucket's ACL (Access Control List) to private. This will ensure that only Owner has full privileges.",
      "remediation.impact": "make this bucket private",
      "compliance.standard": [
        "CIS v1.3.0 (AWS)",
        "NIST 800-53 Rev 5",
        "Multi-Level Protection Scheme (MLPS) v2.0",
        "CIS v1.2.0 (AWS)",
        "SOC 2",
        "GDPR",
        "NIST 800-53 Rev4",
        "ISO 27001:2013",
        "NIST 800-171 Rev1",
        "CSA CCM v3.0.1",
        "HITRUST CSF v9.3",
        "PIPEDA",
        "NIST CSF",
        "CCPA 2018",
        "MITRE ATT&CK [Beta]"
      ],
      "searchModel.query_updated": "config where cloud.type = 'aws' AND api.name='aws-s3api-get-bucket-acl' AND json.rule = \"((((acl.grants[?(@.grantee=='AllUsers')] size > 0) or policyStatus.isPublic is true) and publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration does not exist) or ((acl.grants[?(@.grantee=='AllUsers')] size > 0) and ((publicAccessBlockConfiguration.ignorePublicAcls is false and accountLevelPublicAccessBlockConfiguration does not exist) or (publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration.ignorePublicAcls is false) or (publicAccessBlockConfiguration.ignorePublicAcls is false and accountLevelPublicAccessBlockConfiguration.ignorePublicAcls is false))) or (policyStatus.isPublic is true and ((publicAccessBlockConfiguration.restrictPublicBuckets is false and accountLevelPublicAccessBlockConfiguration does not exist) or (publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration.restrictPublicBuckets is false) or (publicAccessBlockConfiguration.restrictPublicBuckets is false and accountLevelPublicAccessBlockConfiguration.restrictPublicBuckets is false))))\" as X; config where api.name = 'aws-cloudtrail-describe-trails' as Y; filter'$.X.bucketName equals $.Y.s3BucketName'; show X;",
      "remediable_updated": false,
      "remediation.cliScriptTemplate_updated": "",
      "remediation.description_updated": "",
      "remediation.impact_updated": "",
      "impact": "",
      "RLP": "RLP-27164"
    }
  ],
  "1": [
    {
      "policyId": "deb8a07d-b5d1-4105-a10b-fc94f8a34854",
      "policyType": "config",
      "cloudType": "aws",
      "severity": "low",
      "name": "AWS Inactive users for more than 30 days",
      "description": "This policy identifies users who are inactive for more than 30 days. Inactive user accounts are an easy target for attacker because any activity on the account will largely get unnoticed.\nNOTE: Exception to this policy is, it is not valid for SSO login users.",
      "rule.criteria": "619b20cf-7cb5-4e53-a768-be9a85bd58e8",
      "searchModel.query": "config where cloud.type = 'aws' and api.name = 'aws-iam-get-credential-report' AND json.rule = '_DateTime.ageInDays(user_creation_time) > 30 and (password_last_used equals N/A or password_last_used equals no_information or _DateTime.ageInDays(password_last_used) > 30) and ((access_key_1_last_used_date equals N/A or _DateTime.ageInDays(access_key_1_last_used_date) > 30) and (access_key_2_last_used_date equals N/A or _DateTime.ageInDays(access_key_2_last_used_date) > 30))'",
      "recommendation": "1.Sign in to AWS console and navigate to IAM.\n2.Identify the user reported and Make sure that the user has legitimate reason to be inactive for such an extended period.\n3. Delete the user account, if the user no longer needs access to the console or no longer exists.",
      "remediable": false,
      "remediation.cliScriptTemplate": "",
      "remediation.description": "",
      "remediation.impact": "",
      "compliance.standard": [
        "NIST 800-53 Rev 5",
        "Multi-Level Protection Scheme (MLPS) v2.0",
        "CIS v1.2.0 (AWS)",
        "PCI DSS v3.2",
        "SOC 2",
        "NIST 800-53 Rev4",
        "NIST 800-171 Rev1",
        "CSA CCM v3.0.1",
        "HITRUST CSF v9.3",
        "MITRE ATT&CK [Beta]"
      ],
      "description_updated": "This policy identifies users who are inactive for more than 30 days. Inactive user accounts are an easy target for attacker because any activity on the account will largely get unnoticed.\n\nNOTE: Exception to this policy is, it is not valid for SSO login users and Root users",
      "searchModel.query_updated": "config where cloud.type = 'aws' and api.name = 'aws-iam-get-credential-report' AND json.rule = 'user does not equal <root_account> and _DateTime.ageInDays(user_creation_time) > 30 and (password_last_used equals N/A or password_last_used equals no_information or _DateTime.ageInDays(password_last_used) > 30) and ((access_key_1_last_used_date equals N/A or _DateTime.ageInDays(access_key_1_last_used_date) > 30) and (access_key_2_last_used_date equals N/A or _DateTime.ageInDays(access_key_2_last_used_date) > 30))'",
      "impact": "",
      "RLP": "RLP-26596"
    }
  ],
  "2": [
    {
      "policyId": "e8799768-aeda-4d42-897a-29ede5798312",
      "policyType": "config",
      "cloudType": "azure",
      "severity": "low",
      "name": "Azure Security Center contact phone number not set",
      "description": "Ensure that 'Security contact phone number' is set",
      "rule.criteria": "51be4654-4d2d-43c4-9279-58bb38a1d741",
      "searchModel.query": "config where cloud.type = 'azure' AND api.name = 'azure-security-center-settings' AND json.rule = 'securityContacts is empty or securityContacts[*].properties.phone is empty'",
      "recommendation": "From the Azure portal, go to\n1. Security Center\n2. Click on Pricing & Settings\n3. Click on the Subscription\n4. Click 'Email notification'\n5. Add Phone number",
      "remediable": false,
      "remediation.cliScriptTemplate": "",
      "remediation.description": "",
      "remediation.impact": "",
      "compliance.standard": [
        "Multi-Level Protection Scheme (MLPS) v2.0",
        "HIPAA",
        "PCI DSS v3.2",
        "NIST 800-53 Rev4",
        "ISO 27001:2013",
        "CSA CCM v3.0.1",
        "CIS v1.1 (Azure)",
        "SOC 2",
        "HITRUST CSF v9.3",
        "GDPR",
        "NIST CSF"
      ],
      "description_updated": "This policy identifies Azure Security Center contact phone number is empty. It is recommended to update Azure Security Center phone number to receive notifications when Azure Security Center detects compromised resources",
      "searchModel.query_updated": "config where cloud.type = 'azure' AND api.name = 'azure-security-center-settings' AND json.rule = 'securityContacts is empty or securityContacts[?any(properties.phone is empty)] exists'",
      "recommendation_updated": "Use below Azure CLI example command to create new contact with phone number details for Azure Security Center,\n\naz security contact create -n \"default1\" --email 'john@contoso.com' --phone '214275-4038' --alert-notifications 'on' --alerts-admins 'on'\n\nFor more information:\nhttps://docs.microsoft.com/en-us/cli/azure/security/contact?view=azure-cli-latest",
      "impact": "",
      "RLP": "RLP-27756"
    }
  ],
  "3": [
    {
      "policyId": "2b7e07ba-56c8-42db-8db4-a4b65f5066c4",
      "policyType": "config",
      "cloudType": "aws",
      "severity": "low",
      "name": "AWS IAM policy attached to users",
      "description": "This policy identifies IAM policies attached to user. By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.",
      "rule.criteria": "2b7e07ba-56c8-42db-8db4-a4b65f5066c4",
      "searchModel.query": "config where cloud.type = 'aws' and api.name='aws-iam-list-attached-user-policies' AND json.rule='attachedPolicies isType Array and not attachedPolicies size == 0'",
      "recommendation": "1. Sign in to the AWS Console\n2. Navigate to the 'IAM' service.\n3. Identify the users that were specifically assigned to the reported IAM policy.\n4. If a group with a similar policy already exists, put the user into that group. If such a group does not exist, create a new group with relevant policy and assign the user to the group.",
      "remediable": false,
      "remediation.cliScriptTemplate": "",
      "remediation.description": "",
      "remediation.impact": "",
      "compliance.standard": [
        "NIST 800-53 Rev 5",
        "Multi-Level Protection Scheme (MLPS) v2.0",
        "CIS v1.2.0 (AWS)",
        "SOC 2",
        "HIPAA",
        "NIST 800-53 Rev4",
        "ISO 27001:2013",
        "NIST 800-171 Rev1",
        "CSA CCM v3.0.1",
        "HITRUST CSF v9.3",
        "GDPR",
        "PIPEDA",
        "NIST CSF",
        "CCPA 2018",
        "MITRE ATT&CK [Beta]"
      ],
      "description_updated": "This policy identifies IAM policies attached to user. By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups but not users.",
      "impact": "",
      "RLP": "RLP-27165"
    }
  ]
}